<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>JOJO TORNEIOS - Admin Dashboard</title>
    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>üü£</text></svg>">
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: #333;
        }
        .login-container { display: flex; justify-content: center; align-items: center; min-height: 100vh; padding: 20px; }
        .login-box {
            background: rgba(255,255,255,0.95);
            padding: 40px;
            border-radius: 20px;
            box-shadow: 0 15px 50px rgba(0,0,0,0.3);
            width: 100%;
            max-width: 400px;
            text-align: center;
        }
        .login-title { font-size: 2rem; color: #667eea; margin-bottom: 30px; font-weight: bold; }
        .login-input {
            width: 100%;
            padding: 15px;
            margin-bottom: 20px;
            border: 2px solid #e0e0e0;
            border-radius: 10px;
            font-size: 1rem;
        }
        .login-input:focus { outline: none; border-color: #667eea; }
        .login-btn {
            width: 100%;
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            border: none;
            padding: 15px;
            border-radius: 10px;
            font-size: 1.1rem;
            cursor: pointer;
            font-weight: bold;
        }
        .login-btn:hover { transform: translateY(-2px); box-shadow: 0 10px 25px rgba(102, 126, 234, 0.4); }
        .dashboard { display: none; }
        .header {
            background: rgba(255,255,255,0.1);
            padding: 20px;
            text-align: center;
            position: relative;
        }
        .header h1 { color: white; font-size: 2.5rem; text-shadow: 2px 2px 4px rgba(0,0,0,0.3); }
        .logout-btn {
            position: absolute;
            top: 20px;
            right: 20px;
            background: rgba(255,255,255,0.2);
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 8px;
            cursor: pointer;
        }
        .container { max-width: 1400px; margin: 0 auto; padding: 20px; }
        .nav-tabs { display: flex; gap: 10px; margin-bottom: 20px; flex-wrap: wrap; }
        .nav-tab {
            background: rgba(255,255,255,0.2);
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 8px;
            cursor: pointer;
            font-weight: bold;
        }
        .nav-tab.active { background: rgba(255,255,255,0.4); }
        .tab-content { display: none; }
        .tab-content.active { display: block; }
        .stats-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px; margin-bottom: 20px; }
        .stat-card {
            background: rgba(255,255,255,0.95);
            padding: 25px;
            border-radius: 15px;
            text-align: center;
        }
        .stat-number { font-size: 3rem; color: #667eea; font-weight: bold; }
        .stat-label { color: #666; margin-top: 10px; }
        .card { background: rgba(255,255,255,0.95); border-radius: 15px; padding: 20px; margin-bottom: 20px; }
        .card-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; flex-wrap: wrap; gap: 10px; }
        .card-title { font-size: 1.5rem; color: #667eea; font-weight: bold; }
        .btn {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 8px;
            cursor: pointer;
            font-weight: bold;
        }
        .btn:hover { transform: translateY(-2px); box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4); }
        .btn-danger { background: linear-gradient(135deg, #f093fb, #f5576c); }
        .btn-success { background: linear-gradient(135deg, #43e97b, #38f9d7); }
        .btn-sm { padding: 6px 12px; font-size: 0.9rem; }
        .search-bar { width: 100%; padding: 12px; border: 2px solid #e0e0e0; border-radius: 10px; margin-bottom: 20px; font-size: 1rem; }
        table { width: 100%; border-collapse: collapse; background: white; border-radius: 10px; overflow: hidden; }
        th, td { padding: 15px; text-align: left; border-bottom: 1px solid #e0e0e0; }
        th { background: linear-gradient(135deg, #667eea, #764ba2); color: white; font-weight: bold; }
        tr:hover { background: #f5f5f5; }
        .badge { padding: 5px 10px; border-radius: 15px; font-size: 0.85rem; font-weight: bold; }
        .badge-success { background: #d4edda; color: #155724; }
        .badge-danger { background: #f8d7da; color: #721c24; }
        .pagination {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 10px;
            margin-top: 20px;
        }
        .pagination button {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 8px;
            cursor: pointer;
            font-weight: bold;
        }
        .pagination button:disabled { background: #ccc; cursor: not-allowed; opacity: 0.5; }
        .pagination .page-info { color: white; font-weight: bold; padding: 0 15px; }
        .vip-badge {
            display: inline-block;
            padding: 4px 12px;
            border-radius: 12px;
            font-size: 0.85rem;
            font-weight: bold;
            margin-left: 8px;
        }
        .vip-1 { background: linear-gradient(135deg, #f093fb, #f5576c); color: white; }
        .vip-2 { background: linear-gradient(135deg, #4facfe, #00f2fe); color: white; }
        .vip-3 { background: linear-gradient(135deg, #43e97b, #38f9d7); color: white; }
        .vip-4 { background: linear-gradient(135deg, #fa709a, #fee140); color: white; }
        .modal { display: none; position: fixed; z-index: 1000; left: 0; top: 0; width: 100%; height: 100%; background-color: rgba(0,0,0,0.5); }
        .modal-content {
            background-color: white;
            margin: 5% auto;
            padding: 30px;
            border-radius: 15px;
            width: 90%;
            max-width: 600px;
        }
        .close { float: right; font-size: 28px; font-weight: bold; cursor: pointer; color: #999; }
        .close:hover { color: #333; }
        .form-group { margin-bottom: 20px; }
        .form-label { display: block; margin-bottom: 8px; font-weight: bold; color: #667eea; }
        .form-input { width: 100%; padding: 10px; border: 2px solid #e0e0e0; border-radius: 8px; }
        .alert { padding: 15px; border-radius: 8px; margin-bottom: 20px; }
        .alert-success { background: #d4edda; color: #155724; }
        .alert-error { background: #f8d7da; color: #721c24; }
        .ban-source {
            display: inline-block;
            padding: 3px 8px;
            border-radius: 4px;
            font-size: 0.8rem;
            margin-left: 8px;
        }
        .ban-room { background: #ffa726; color: white; }
        .ban-admin { background: #ef5350; color: white; }
        .ban-auto { background: #ab47bc; color: white; }
    </style>
</head>
<body>
    <div id="loginScreen" class="login-container">
        <div class="login-box">
            <h1 class="login-title">üü£ JOJO ADMIN</h1>
            <input type="password" id="loginPassword" class="login-input" placeholder="Senha do Admin">
            <button onclick="login()" class="login-btn">Entrar</button>
            <div id="loginError" class="alert alert-error" style="display: none;"></div>
        </div>
    </div>

    <div id="dashboard" class="dashboard">
        <div class="header">
            <h1>üü£ JOJO TORNEIOS - ADMIN üü£</h1>
            <button onclick="logout()" class="logout-btn">üö™ Sair</button>
        </div>

        <div class="container">
            <div class="nav-tabs">
                <button class="nav-tab active" onclick="showTab('overview')">üìä Vis√£o Geral</button>
                <button class="nav-tab" onclick="showTab('players')">üë• Jogadores</button>
                <button class="nav-tab" onclick="showTab('vips')">üíé VIPs</button>
                <button class="nav-tab" onclick="showTab('bans')">üö´ Banimentos</button>
                <button class="nav-tab" onclick="showTab('history')">üìã Hist√≥rico</button>
                <button class="nav-tab" onclick="showTab('logs')">üìù Logs</button>
            </div>

            <!-- VIS√ÉO GERAL -->
            <div id="overview" class="tab-content active">
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-number" id="totalPlayers">-</div>
                        <div class="stat-label">Jogadores Registrados</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number" id="totalLogins">-</div>
                        <div class="stat-label">Total de Logins</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number" id="totalBans">-</div>
                        <div class="stat-label">Jogadores Banidos</div>
                    </div>
                </div>

                <div class="card">
                    <div class="card-header">
                        <div class="card-title">‚ö° A√ß√µes R√°pidas</div>
                        <button onclick="loadData()" class="btn">üîÑ Atualizar Dados</button>
                    </div>
                    <div style="display: flex; gap: 15px; flex-wrap: wrap;">
                        <button onclick="showTab('players')" class="btn">üë• Gerenciar Jogadores</button>
                        <button onclick="showTab('vips')" class="btn">üíé Gerenciar VIPs</button>
                        <button onclick="showTab('bans')" class="btn">üö´ Gerenciar Bans</button>
                        <button onclick="exportData()" class="btn">üì• Exportar Dados</button>
                    </div>
                </div>
            </div>

            <!-- JOGADORES -->
            <div id="players" class="tab-content">
                <div class="card">
                    <div class="card-header">
                        <div class="card-title">üë• Todos os Jogadores</div>
                        <button onclick="loadPlayers()" class="btn">üîÑ Atualizar</button>
                    </div>
                    
                    <input type="text" class="search-bar" placeholder="üîç Pesquisar por Discord ou Nick..." id="playersSearch" oninput="filterPlayers()">
                    
                    <table id="playersTable">
                        <thead>
                            <tr>
                                <th>#</th>
                                <th>Discord</th>
                                <th>Nick Haxball</th>
                                <th>Registro</th>
                                <th>Status</th>
                                <th>A√ß√µes</th>
                            </tr>
                        </thead>
                        <tbody id="playersTableBody"></tbody>
                    </table>
                    
                    <div class="pagination">
                        <button onclick="changePage('players', -1)" id="playersPrevBtn">‚Üê Anterior</button>
                        <span class="page-info" id="playersPageInfo">P√°gina 1</span>
                        <button onclick="changePage('players', 1)" id="playersNextBtn">Pr√≥xima ‚Üí</button>
                    </div>
                </div>
            </div>

            <!-- VIPS -->
            <div id="vips" class="tab-content">
                <div class="card">
                    <div class="card-header">
                        <div class="card-title">üíé Gerenciar VIPs</div>
                        <button onclick="showAddVipModal()" class="btn btn-success">‚ûï Adicionar VIP</button>
                    </div>
                    
                    <table id="vipsTable">
                        <thead>
                            <tr>
                                <th>Nick</th>
                                <th>N√≠vel VIP</th>
                                <th>Data In√≠cio</th>
                                <th>Data Fim</th>
                                <th>Tempo Restante</th>
                                <th>A√ß√µes</th>
                            </tr>
                        </thead>
                        <tbody id="vipsTableBody"></tbody>
                    </table>
                </div>
            </div>

            <!-- BANIMENTOS -->
            <div id="bans" class="tab-content">
                <div class="card">
                    <div class="card-header">
                        <div class="card-title">üö´ Jogadores Banidos</div>
                        <button onclick="loadBannedPlayers()" class="btn">üîÑ Atualizar</button>
                    </div>
                    
                    <input type="text" class="search-bar" placeholder="üîç Pesquisar banidos..." id="bansSearch" oninput="filterBans()">
                    
                    <table id="bansTable">
                        <thead>
                            <tr>
                                <th>Nick</th>
                                <th>Motivo</th>
                                <th>Banido Por</th>
                                <th>Origem</th>
                                <th>Data</th>
                                <th>Expira</th>
                                <th>A√ß√µes</th>
                            </tr>
                        </thead>
                        <tbody id="bansTableBody"></tbody>
                    </table>
                    
                    <div class="pagination">
                        <button onclick="changePage('bans', -1)" id="bansPrevBtn">‚Üê Anterior</button>
                        <span class="page-info" id="bansPageInfo">P√°gina 1</span>
                        <button onclick="changePage('bans', 1)" id="bansNextBtn">Pr√≥xima ‚Üí</button>
                    </div>
                </div>
            </div>

            <!-- HIST√ìRICO -->
            <div id="history" class="tab-content">
                <div class="card">
                    <div class="card-header">
                        <div class="card-title">üìã Hist√≥rico de A√ß√µes</div>
                        <button onclick="loadPlayerHistory()" class="btn">üîÑ Atualizar</button>
                    </div>
                    <div id="historyContent"></div>
                </div>
            </div>

            <!-- LOGS -->
            <div id="logs" class="tab-content">
                <div class="card">
                    <div class="card-header">
                        <div class="card-title">üìù Logs do Sistema</div>
                        <button onclick="loadSystemLogs()" class="btn">üîÑ Atualizar</button>
                    </div>
                    <div id="logsContent"></div>
                </div>
            </div>
        </div>
    </div>

    <!-- MODAL DETALHES DO JOGADOR -->
    <div id="playerModal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closePlayerModal()">&times;</span>
            <h2 id="playerModalTitle" style="color: #667eea; margin-bottom: 20px;"></h2>
            <div id="playerModalContent"></div>
        </div>
    </div>

    <!-- MODAL ADICIONAR VIP -->
    <div id="vipModal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeVipModal()">&times;</span>
            <h2 style="color: #667eea; margin-bottom: 20px;">üíé Adicionar VIP</h2>
            <div class="form-group">
                <label class="form-label">Nick do Jogador</label>
                <input type="text" id="vipNick" class="form-input" placeholder="Digite o nick">
            </div>
            <div class="form-group">
                <label class="form-label">N√≠vel VIP</label>
                <select id="vipLevel" class="form-input">
                    <option value="1">VIP 1 - jojo lover üíú</option>
                    <option value="2">VIP 2 - Vip üíé</option>
                    <option value="3">VIP 3 - Premium ‚ú®</option>
                    <option value="4">VIP 4 - Purple üü£</option>
                </select>
            </div>
            <div class="form-group">
                <label class="form-label">Dura√ß√£o (dias)</label>
                <input type="number" id="vipDuration" class="form-input" placeholder="30" value="30">
            </div>
            <button onclick="addVip()" class="btn btn-success" style="width: 100%;">Adicionar VIP</button>
        </div>
    </div>

    <script>
        const API_BASE_URL = 'https://jojotorneios-qhjm.onrender.com';
        let playersData = [];
        let bannedData = [];
        let vipsData = [];
        
        // Pagina√ß√£o
        let currentPage = { players: 1, bans: 1 };
        let itemsPerPage = 20;

        // LOGIN
        async function login() {
            const password = document.getElementById('loginPassword').value;
            try {
                const response = await fetch(`${API_BASE_URL}/api/admin_login`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ password })
                });
                const data = await response.json();
                if (data.success) {
                    document.getElementById('loginScreen').style.display = 'none';
                    document.getElementById('dashboard').style.display = 'block';
                    loadData();
                } else {
                    document.getElementById('loginError').textContent = '‚ùå Senha incorreta!';
                    document.getElementById('loginError').style.display = 'block';
                }
            } catch (error) {
                console.error('Erro no login:', error);
                document.getElementById('loginError').textContent = '‚ùå Erro ao conectar!';
                document.getElementById('loginError').style.display = 'block';
            }
        }

        function logout() {
            document.getElementById('dashboard').style.display = 'none';
            document.getElementById('loginScreen').style.display = 'flex';
            document.getElementById('loginPassword').value = '';
        }

        // NAVEGA√á√ÉO
        function showTab(tabName) {
            document.querySelectorAll('.tab-content').forEach(tab => tab.classList.remove('active'));
            document.querySelectorAll('.nav-tab').forEach(tab => tab.classList.remove('active'));
            document.getElementById(tabName).classList.add('active');
            event.target.classList.add('active');
            
            if (tabName === 'players') loadPlayers();
            if (tabName === 'vips') loadVips();
            if (tabName === 'bans') loadBannedPlayers();
            if (tabName === 'history') loadPlayerHistory();
            if (tabName === 'logs') loadSystemLogs();
        }

        // CARREGAR DADOS
        async function loadData() {
            try {
                const statsRes = await fetch(`${API_BASE_URL}/api/stats`);
                const stats = await statsRes.json();
                document.getElementById('totalPlayers').textContent = stats.total_players || 0;
                document.getElementById('totalLogins').textContent = stats.total_logins || 0;
                document.getElementById('totalBans').textContent = stats.total_bans || 0;
            } catch (error) {
                console.error('Erro ao carregar stats:', error);
            }
        }

        async function loadPlayers() {
            try {
                const response = await fetch(`${API_BASE_URL}/api/players`);
                const data = await response.json();
                playersData = data.players || [];
                renderPlayers();
            } catch (error) {
                console.error('Erro ao carregar jogadores:', error);
            }
        }

        function renderPlayers() {
            const tbody = document.getElementById('playersTableBody');
            const searchTerm = document.getElementById('playersSearch').value.toLowerCase();
            
            let filtered = playersData.filter(p => 
                (p.discord_username?.toLowerCase() || '').includes(searchTerm) ||
                (p.haxball_nick?.toLowerCase() || '').includes(searchTerm)
            );
            
            const start = (currentPage.players - 1) * itemsPerPage;
            const end = start + itemsPerPage;
            const paginated = filtered.slice(start, end);
            
            tbody.innerHTML = paginated.map((player, i) => `
                <tr>
                    <td>${start + i + 1}</td>
                    <td>${player.discord_username || '-'}</td>
                    <td>${player.haxball_nick || '-'}</td>
                    <td>${new Date(player.created_at).toLocaleDateString('pt-BR')}</td>
                    <td><span class="badge ${player.banned ? 'badge-danger' : 'badge-success'}">${player.banned ? 'BANIDO' : 'ATIVO'}</span></td>
                    <td>
                        <button onclick="viewPlayerDetails('${player.haxball_nick}')" class="btn btn-sm">üìä Ver Stats</button>
                        <button onclick="showBanPlayer('${player.haxball_nick}')" class="btn btn-sm btn-danger">üö´ Banir</button>
                    </td>
                </tr>
            `).join('');
            
            updatePagination('players', filtered.length);
        }

        async function loadBannedPlayers() {
            try {
                const response = await fetch(`${API_BASE_URL}/api/players`);
                const data = await response.json();
                bannedData = (data.players || []).filter(p => p.banned);
                renderBannedPlayers();
            } catch (error) {
                console.error('Erro ao carregar banidos:', error);
            }
        }

        function renderBannedPlayers() {
            const tbody = document.getElementById('bansTableBody');
            const searchTerm = document.getElementById('bansSearch')?.value.toLowerCase() || '';
            
            let filtered = bannedData.filter(p => 
                (p.haxball_nick?.toLowerCase() || '').includes(searchTerm)
            );
            
            const start = (currentPage.bans - 1) * itemsPerPage;
            const end = start + itemsPerPage;
            const paginated = filtered.slice(start, end);
            
            tbody.innerHTML = paginated.map(player => `
                <tr>
                    <td>${player.haxball_nick || '-'}</td>
                    <td>${player.ban_reason || 'N√£o informado'}</td>
                    <td>${player.banned_by || 'Sistema'}</td>
                    <td><span class="ban-source ${player.banned_by === 'Sistema' ? 'ban-auto' : player.banned_by?.includes('Admin') ? 'ban-admin' : 'ban-room'}">${player.banned_by === 'Sistema' ? 'AUTO' : player.banned_by?.includes('Admin') ? 'ADMIN' : 'SALA'}</span></td>
                    <td>${player.banned_at ? new Date(player.banned_at).toLocaleString('pt-BR') : '-'}</td>
                    <td>${player.ban_expires ? new Date(player.ban_expires).toLocaleString('pt-BR') : 'Permanente'}</td>
                    <td>
                        <button onclick="unbanPlayer('${player.haxball_nick}')" class="btn btn-sm btn-success">‚úÖ Desbanir</button>
                    </td>
                </tr>
            `).join('');
            
            updatePagination('bans', filtered.length);
        }

        async function loadVips() {
            // TODO: Implementar endpoint de VIPs
            document.getElementById('vipsTableBody').innerHTML = '<tr><td colspan="6" style="text-align: center; color: #999;">Sistema de VIPs em desenvolvimento</td></tr>';
        }

        async function loadPlayerHistory() {
            try {
                const response = await fetch(`${API_BASE_URL}/api/player_history?limit=50`);
                const data = await response.json();
                const content = document.getElementById('historyContent');
                
                if (data.history && data.history.length > 0) {
                    content.innerHTML = data.history.map(h => `
                        <div class="log-item">
                            <div class="log-header">
                                <strong>${h.player_name || '-'}</strong>
                                <span style="color: #999; font-size: 0.9rem;">${new Date(h.timestamp).toLocaleString('pt-BR')}</span>
                            </div>
                            <div>${h.action_type}: ${h.action_details || '-'}</div>
                        </div>
                    `).join('');
                } else {
                    content.innerHTML = '<p style="text-align: center; color: #999;">Nenhum hist√≥rico encontrado</p>';
                }
            } catch (error) {
                console.error('Erro ao carregar hist√≥rico:', error);
            }
        }

        async function loadSystemLogs() {
            try {
                const response = await fetch(`${API_BASE_URL}/api/system_logs?limit=50`);
                const data = await response.json();
                const content = document.getElementById('logsContent');
                
                if (data.logs && data.logs.length > 0) {
                    content.innerHTML = data.logs.map(log => `
                        <div class="log-item">
                            <div class="log-header">
                                <strong style="color: #667eea;">${log.log_type || 'INFO'}</strong>
                                <span style="color: #999; font-size: 0.9rem;">${new Date(log.timestamp).toLocaleString('pt-BR')}</span>
                            </div>
                            <div>${log.log_message || '-'}</div>
                        </div>
                    `).join('');
                } else {
                    content.innerHTML = '<p style="text-align: center; color: #999;">Nenhum log encontrado</p>';
                }
            } catch (error) {
                console.error('Erro ao carregar logs:', error);
            }
        }

        // PAGINA√á√ÉO
        function changePage(type, direction) {
            currentPage[type] += direction;
            if (currentPage[type] < 1) currentPage[type] = 1;
            
            if (type === 'players') renderPlayers();
            if (type === 'bans') renderBannedPlayers();
        }

        function updatePagination(type, totalItems) {
            const totalPages = Math.ceil(totalItems / itemsPerPage);
            document.getElementById(`${type}PageInfo`).textContent = `P√°gina ${currentPage[type]} de ${totalPages}`;
            document.getElementById(`${type}PrevBtn`).disabled = currentPage[type] === 1;
            document.getElementById(`${type}NextBtn`).disabled = currentPage[type] >= totalPages;
        }

        function filterPlayers() {
            currentPage.players = 1;
            renderPlayers();
        }

        function filterBans() {
            currentPage.bans = 1;
            renderBannedPlayers();
        }

        // A√á√ïES
        async function viewPlayerDetails(nick) {
            // TODO: Implementar modal com stats completos
            alert(`Ver detalhes de ${nick} (em desenvolvimento)`);
        }

        async function showBanPlayer(nick) {
            if (confirm(`Deseja realmente banir ${nick}?`)) {
                try {
                    const reason = prompt('Motivo do ban:') || 'Banido por admin';
                    const response = await fetch(`${API_BASE_URL}/api/ban_player`, {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({ player_name: nick, reason, banned_by: 'Admin Dashboard' })
                    });
                    const data = await response.json();
                    if (data.success) {
                        alert('‚úÖ Jogador banido com sucesso!');
                        loadPlayers();
                        loadData();
                    }
                } catch (error) {
                    alert('‚ùå Erro ao banir jogador!');
                }
            }
        }

        async function unbanPlayer(nick) {
            if (confirm(`Deseja desbanir ${nick}?`)) {
                try {
                    const response = await fetch(`${API_BASE_URL}/api/unban_player`, {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({ player_name: nick, unbanned_by: 'Admin Dashboard' })
                    });
                    const data = await response.json();
                    if (data.success) {
                        alert('‚úÖ Jogador desbanido com sucesso!');
                        loadBannedPlayers();
                        loadData();
                    }
                } catch (error) {
                    alert('‚ùå Erro ao desbanir jogador!');
                }
            }
        }

        function closePlayerModal() {
            document.getElementById('playerModal').style.display = 'none';
        }

        function showAddVipModal() {
            document.getElementById('vipModal').style.display = 'block';
        }

        function closeVipModal() {
            document.getElementById('vipModal').style.display = 'none';
        }

        async function addVip() {
            // TODO: Implementar endpoint de adicionar VIP
            alert('Sistema de VIP em desenvolvimento');
        }

        function exportData() {
            const data = {
                players: playersData,
                banned: bannedData,
                exported_at: new Date().toISOString()
            };
            const blob = new Blob([JSON.stringify(data, null, 2)], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `jojo_data_${new Date().toISOString().split('T')[0]}.json`;
            a.click();
        }

        // Login com Enter
        document.getElementById('loginPassword')?.addEventListener('keypress', (e) => {
            if (e.key === 'Enter') login();
        });
    </script>
</body>
</html>
